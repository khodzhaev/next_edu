{% extends 'base.html' %}
{% block content %}
{% load static %}

<div class="bg-dark">
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="{% url 'index' %}"><img class="logo" src="{% static 'img/logo.png' %}" alt=""></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02"
                    aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
                    <li class="nav-item mx-2">
                        <a class="nav-link px-3 text-white btn btn-outline-danger" href="" data-toggle="modal"
                           data-target="#upload"><i class="fas fa-cloud-upload-alt"></i> Загрузить домашку</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a id="btn-history" class="nav-link px-3 text-white btn btn-outline-info"><i class="far fa-file-alt"></i> История</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a id="btn-tests" class="nav-link px-3 text-white btn btn-outline-info"><i class="far fa-file-alt"></i> Тест</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a id="btn-back" class="nav-link px-3 text-white btn btn-outline-info hidden"><i class="fas fa-arrow-left"></i> Назад</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link" href="{% url 'logout' %}"><i class="fas fa-sign-in-alt"></i> Выйти</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
</div>
<!-- Inquiry Modal -->
<div class="modal fade" id="upload" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="inquiryModalLabel">Загрузите файлы в архиве, файл не должен быть более 2.5
                    мегабайта
                </h5>
                <button type="button" class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="{% url 'upload_hws' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}

                    <input type="hidden" name="student" value="{{ user.id }}">
                    <input type="hidden" name="group" value="{{ user.student.group }}">
                    <input type="file" class="" name="upload" required>
                    <br><br>
                    <input type="submit" class="btn btn-block btn-success" value="Отправить">
                </form>
                <hr>
                <a class="btn btn-block btn-dark text-white" data-dismiss="modal">Закрыть</a>
            </div>
        </div>
    </div>
</div>
{% include '_partials/_alerts.html' %}
<section class="py-5" id="dash-lessons"><br>
    <div class="sh container py-5 bg-white">
        <div class="row">
            <div class="col-lg-6">
                <h5 class="">Последние уроки</h5>
            </div>
            <div class="col-auto ml-auto">
                <h5>Ваш текущий рейтинг <span class="name"><i class="fas fa-star-half-alt"></i> {{ user.student.rating }}</span>/100
                    <i id="info" class="far fa-question-circle"
                       onmouseover="document.getElementById('info-block').style.display = 'block';"
                       onmouseout="document.getElementById('info-block').style.display = 'none';"></i></h5>
                <div id="info-block">
                    <h5>Система рейтинга</h5>
                    <p>У каждого студента по умолчанию по <b>100 баллов</b></p>
                    <hr>
                    <p> за не посщение урока <b>-5 балла</b>
                        <br>за не выполнение урока <b>-5 балла</b>
                    </p>
                    <p> Если вы будете саблюдать все правила то после итогового результата вы сможете получить
                        Сертификаты и Сувениры </p>
                </div>
            </div>
        </div>
        <hr>
        <br>
        <div class="row">
            <div class="col-lg-12">
                <table class="table table-striped">
                    <thead class="table-dark">
                    <tr>
                        <th>Дата</th>
                        <th>Название</th>
                        <th>Скачать урок</th>
                        <th>Смотреть видео</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for l in lessons %}
                    <tr>
                        <td>{{ l.datepublished }}</td>
                        <td>{{ l.title }}</td>
                        <td><a href="{% url 'download' l.id %}">Скачать урок</a></td>
                        <td><a href="{{ l.video }}" target="_blank"
                               class="btn btn-info btn-sm"> Смотреть</a></td>
                    </tr>
                    {% endfor %}
                    <script>

                    </script>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<section class="py-5 hidden" id="dash-history"><br>
    <div class="sh container py-5 bg-white">
        <div class="row">
            <div class="col-lg-6">
                <h5 class="">История</h5>
            </div>
        </div>
        <hr>
        <br>
        <div class="row">
            <div class="col-lg-12">
                <table class="table table-striped">
                    <thead class="table-dark">
                    <tr>
                        <th>Дата</th>
                        <th>Название</th>
                        <th>Удалить</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for h in hws %}
                    <tr>
                        <td>{{ h.datepublished }}</td>
                        <td>{{ h.upload }}</td>
                        <td><a href="{% url 'delete_self_hws' h.id %}" class="btn btn-danger btn-sm">Удалить</a></td>
                    </tr>
                    {% endfor %}
                    <script>

                    </script>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<section class="py-5 hidden" id="dash-tests"><br>
    <div class="sh container py-5 bg-white">
        <div class="row">
            <div class="col-lg-6">
                <h5 class="">Тесты</h5>
            </div>
        </div>
        <hr>
        <br>
        <div class="row">
            <div class="col-lg-12">
                <table class="table table-striped">
                    <thead class="table-dark">
                    <tr>
                        <th>Дата</th>
                        <th>Название</th>
                        <th>Перейти</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for t in tests %}
                    <tr>
                        <td>{{ t.date_pub }}</td>
                        <td>{{ t.title }}</td>
                        {% if t.teststudent_set.first.avaible == False %}
                        <td><a class="btn btn-info btn-sm text-white">{{t.teststudent_set.first.point}}</a></td>
                        {% else %}
                        <td><a href="{% url 'dashboard_test' t.id %}" class="btn btn-success btn-sm">Пройти</a></td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    <script>

                    </script>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<script>
    'use strict';
    document.getElementById('btn-history').addEventListener('click', function () {
        document.getElementById('btn-history').classList.add('hidden')
        document.getElementById('btn-tests').classList.add('hidden')
        document.getElementById('btn-back').classList.remove('hidden')
        document.getElementById('dash-history').classList.remove('hidden')
        document.getElementById('dash-lessons').classList.add('hidden')
        document.getElementById('dash-tests').classList.add('hidden')
    })
    document.getElementById('btn-tests').addEventListener('click', function () {
        document.getElementById('btn-history').classList.add('hidden')
        document.getElementById('btn-tests').classList.add('hidden')
        document.getElementById('btn-back').classList.remove('hidden')
        document.getElementById('dash-history').classList.add('hidden')
        document.getElementById('dash-lessons').classList.add('hidden')
        document.getElementById('dash-tests').classList.remove('hidden')
    })
    document.getElementById('btn-back').addEventListener('click', function () {
        document.getElementById('btn-history').classList.remove('hidden')
        document.getElementById('btn-tests').classList.remove('hidden')
        document.getElementById('btn-back').classList.add('hidden')
        document.getElementById('dash-tests').classList.add('hidden')
        document.getElementById('dash-history').classList.add('hidden')
        document.getElementById('dash-lessons').classList.remove('hidden')
    })

</script>
{% endblock %}
